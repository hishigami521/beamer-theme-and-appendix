\documentclass[dvipdfmx]{beamer}
\AtBeginDvi{\special{pdf:tounicode EUC-UCS2}}
\usetheme{hishigami}

%%% package setting %%%
\usepackage{mathtools,amssymb,amsfonts}
\usepackage[noend]{algpseudocode}
\usepackage{varwidth}
\usepackage{rgb}
\usepackage{graphicx}
\usepackage{tikz}

\makeatletter
\algdef{SE}[DO]{Do}{EndDo}[1]{\algorithmicdo\ #1}{\algorithmicend\ \algorithmicdo}%
\ifthenelse{\equal{\ALG@noend}{t}}%
   {%
   \algtext*{EndDo}%
   }{}%
\makeatother
\newcommand{\algif}{\algorithmicif\ }
\newcommand{\algthen}{\algorithmicthen\ }

%%% font setting %%%
\usepackage{txfonts}
%% \usepackage{newtxmath}
%% \usepackage{mathptmx}
%% \SetSymbolFont{operators}{bold}{OT1}{txr}{bx}{n}
%% \SetSymbolFont{letters}{bold}{OML}{txmi}{bx}{it}
%% \SetSymbolFont{symbols}{bold}{OMS}{txsy}{bx}{n}
%% \SetSymbolFont{largesymbols}{bold}{OMX}{txex}{bx}{n}
\usepackage{bm}
\usepackage{hhline}
%% \renewcommand{\familydefault}{\sfdefault}
%% \renewcommand{\kanjifamilydefault}{\gtdefault}

\title[実対称帯行列の部分固有対計算のための2分法と逆反復法に基づく並列ソルバ]
      {実対称帯行列の部分固有対計算のための\\
        2分法と逆反復法に基づく並列ソルバ}
      \author[石上~裕之]{石上~裕之}
      \institute[数理工学専攻~数理解析分野~D3]{数理工学専攻~数理解析分野 博士後期課程3年\\
        \vspace{2ex}
        \scriptsize{共同研究者: 長谷川秀彦（筑波大学）木村欣司 中村佳正（京都大学）}
      }
      \date{計算科学ユニット第12回研究交流会~~Mar.~9th, 2016}
\begin{document}
\setlength\abovedisplayskip{0ex}
\setlength\belowdisplayskip{0ex}
\setlength\itemsep{0em}
\setlength\floatsep{-1ex}
\setlength\textfloatsep{-1ex}
\setlength\intextsep{-1ex}

\frame{\titlepage}

\begin{frame}
  \frametitle{部分固有対計算}
  \begin{block}{Def.~固有対 $\left( \lambda_k,\bm{q}_k \right)$}
    \begin{itemize}
    \item 実\textcolor{red}{対称}$n$次行列$A$の固有対$\left( \lambda_k,\bm{q}_k \right)$は，以下を満たす:  
      \begin{center}
	$A \bm{q}_k=\lambda_k \bm{q}_k,\ \quad k=1,\ \dots,\ n$
      \end{center}
      \begin{itemize}
      \item $\lambda_k\ (\in \mathbb{R})$: $A$の固有値 ($\lambda_1 \ge \cdots \ge \lambda_n$)
      \item $\bm{q}_k\ (\in \mathbb{R}^n)$: $\lambda_k$に対応する固有ベクトル
      \end{itemize}
    \end{itemize}
  \end{block}
  
  \begin{itemize}
  \item 実対称\textbf{密}行列の\textcolor{blue}{部分}固有対計算の応用:
    \begin{itemize}
    \item 振動解析 / 分子軌道法
    \item カーネル主成分分析 [Sch\"{o}lkopf-Smola-M\"{u}ller (1998)]
    \item[\checkmark] 部分特異対計算%（$\to$ 低ランク近似/主成分分析/最小二乗法）
    \end{itemize}
  \end{itemize}
  \begin{itemize}
  \item[\checkmark] 問題（入力行列）の大規模化 $\to$ \textcolor{red}{並列計算}による高速化
    \begin{itemize}
    \item マルチコア計算（共有メモリ, 1ノード）
    \item 大規模分散並列計算（スーパーコンピュータ）
    \item アクセラレータ（Intel Xeon Phi Co-processor, GPU）
    \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{部分固有対計算の方法}
  \begin{exampleblock}{実対称密行列の部分固有対計算}
  \input{one_phase_tridiag_evd_en.tex}
  \begin{itemize}
  \item $A$から直接計算するのではなく，以下の3段階に分けて計算
    \begin{enumerate}
    \item 3重対角化（1-step [Wilkinson (1962), etc.] または 2-step）
      \begin{center}
        $T:= V_T A V_T^\top$
      \end{center}
    \item 実対称3重対角行列$T$の固有対を計算
    \item 逆変換: $T$の固有ベクトルから$A$の固有ベクトルを計算: 
      \begin{center}
      $\bm{q}_k := V_T \bm{q}_k \quad \text{for $k=1,\dots,\ell$}$
      \end{center}
    \end{enumerate}
  \end{itemize}
  \end{exampleblock}

  \begin{alertblock}{Krylov部分空間を用いた固有対計算（Lanczos法など）}
    \begin{itemize}
    \item $A$が疎行列，要求される固有対の数が少ない場合には\underline{時として}有効
      \begin{itemize}
      \item[\checkmark] ロバスト性が保証されていない
      \end{itemize}
    \end{itemize}
  \end{alertblock}

\end{frame}

\begin{frame}
  \frametitle{部分固有対計算の並列実装 (1/2)}
  %% \input{one_phase_tridiag_evd_en.tex}
  %% \begin{itemize}
  %% \item 1-step tridiagonalization (3重対角化): Full-to-Tri
  %%   \begin{itemize}
  %%   \item Householder tridiagonalization [Wilkinson (1962)]
  %%   \item[\checkmark] Dongarra's algorithm [Dongarra et al.~(1989)]: ブロック版
  %%   \end{itemize}
  %% \end{itemize}
  %% \vfill
  \input{two_phase_tridiag_evd_en.tex}
  \begin{itemize}
  \item 2-step tridiagonalization: Full-to-Band + Band-to-Tri
    \begin{itemize}
    \item Bischof's algorithm [Bischof-Lang-Sun (1993/2000)]
      \begin{itemize}
      \item $A \to B$: 高性能なアルゴリズムが提案されている
      \item[\checkmark] $B \to T$: スケーラビリティが課題
      \end{itemize}
    \item $B \to T$の性能: 逆変換の計算量とのトレードオフ
    \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{部分固有対計算の並列実装 (2/2)}
  \input{one_phase_band_evd_en.tex}
  \begin{itemize}
  \item 3重対角行列$T$ではなく，\underline{帯行列$B$に変換}
    \begin{enumerate}
    \item 帯行列化 [Bischof-Lang-Sun (1993/2000), etc.]
      \begin{center}
        $B:=  V_B A V_B^\top$
      \end{center}
      %% \begin{itemize}
      %% \item $B$の半帯幅$w$が$64$$256$のときににおいて
      %% \end{itemize}
    \item \textcolor{red}{実対称帯行列$B$の固有対を計算}
    \item 逆変換: $B$の固有ベクトルから$A$の固有ベクトルを計算
      \begin{center}
        $\bm{q}_k := V_B \bm{q}_k \quad \text{for $k=1,\dots,\ell$}$
      \end{center}
    \end{enumerate}
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{実対称帯行列の固有対計算アルゴリズム}
  \begin{exampleblock}{実対称帯行列の固有対計算アルゴリズム}
    \begin{itemize}
    \item 分割統治法 [Imamura {\em et al.} (2011)] 
      \begin{itemize}
      \item 実対称\underline{5重}対角行列の全固有対計算向け
      \item[\checkmark] 必要な固有対が少ない場合には不適当
      \end{itemize}
    \item[\checkmark] 2分法+逆反復法 [Gupta (1973) / Murata (1986)]
      \begin{itemize}
      \item 部分固有対計算向け
      \item 任意の半帯幅$w$に対して適用可能
      \end{itemize}
    \end{itemize}
  \end{exampleblock}

  \begin{alertblock}{本研究の目的\&本講演の内容}
      \begin{itemize}
      \item 本研究の目的:
        \begin{itemize}
        \item 実対称帯行列の部分固有対計算のためのアルゴリズムの改良・確立
        \end{itemize}
      \item 本講演の内容:
        \begin{itemize}
        \item Murataの方法を共有メモリ型マルチコア計算機向けに再実装
        \item[\checkmark] 固有ベクトル計算の高速アルゴリズムの提案
        \end{itemize}
      \end{itemize}
  \end{alertblock}
\end{frame}

\begin{frame}
  \frametitle{2分法による固有値計算}
  \begin{block}{2分法による固有値計算 [Kahan (1966), etc.]}
    \begin{itemize}
    \item 区間$(\mu^L,\mu^R]$に固有値があるかどうかを2分探索によって計算
      \begin{itemize}
      \item $\nu_T(\mu)$（$T$の$\mu(:=(\mu^L+\mu^R)/2)$以下の固有値の数）の計算
      \item[\checkmark] \textcolor{red}{相対精度}の意味で高精度
      \end{itemize}
    \item 固有値を独立に計算できる: \textcolor{blue}{並列計算向き}
    \end{itemize}
  \end{block}

  \begin{exampleblock}{2分法の既存実装} 
    \begin{itemize}
    \item 実対称3重対角行列向け
      \begin{itemize}
      \item 逐次実装: \texttt{xstebz} [Kahan (1966), etc.] in LAPACK
      \item 並列実装:
        \begin{itemize}
        \item 分散並列向け: \texttt{pxstebz} [Demmel-Dhillon-Ren (1994)] in ScaLAPACK
        \item 多分法 [Lo-Philippe-Sameh (1987)] [Simon (1989)]
        \item 多固有値多分法 [Katagiri-V\"{o}mel-Demmel (2007)]
        \end{itemize}
      \end{itemize}
    \item 実対称帯行列向け [Gupta (1973)] [Murata (1986)]
      \begin{itemize}
      \item[\checkmark] $\nu_B(\mu)$の計算法が異なる
      \end{itemize}
    \end{itemize}
  \end{exampleblock}

\end{frame}

%%% Gupta vs. Murata in bisection
\begin{frame}
  \frametitle{実対称帯行列向け2分法の実装}
  \begin{block}{[Gupta (1973)]による実対称帯行列向け2分法の実装}
    \begin{itemize}
    \item Strumの定理に基づき，Martin-Wilkinsonの特殊ガウスによって計算
      \begin{itemize}
      \item BLAS 1 + Partial pivoting $\to$ 安定
      \item 計算量: \underline{$3w^2 n$}
      \end{itemize}
    \end{itemize}
  \end{block}

  \begin{alertblock}{[Murata (1986)]による実対称帯行列向け2分法の実装}
    \begin{itemize}
    \item $\nu_B(\mu)$を2種類の方法で計算する実装:
      \begin{enumerate}
      \item \textcolor{red}{速度優先}の実装: Sylvester慣性則に基づくLU分解 ($B-\mu I = LU$) 
        \begin{itemize}
        \item[\checkmark] \textcolor{blue}{数値不安定} / 計算量: \underline{$w^2 n$} 
        \item 本研究では，ブロック実装（BLAS 2 や BLAS 3が適用できる）
        \end{itemize}
      \item \textcolor{red}{精度優先}の実装: Martin-Wilkinsonの特殊ガウス
      \end{enumerate}
    \item 1 $\to$ 2 への変更基準:
      \begin{itemize}
      \item LU分解の破綻、または、$L$の対角要素の絶対値が非常に小さい
      \end{itemize}
    \end{itemize}
  \end{alertblock}
  \begin{itemize}
  \item[\checkmark] Murataの方法は，Guptaの方法よりも高速と期待できる
  \end{itemize}
\end{frame}

%%% parallel bisection
\begin{frame}[shrink]
  \frametitle{実対称帯行列に対する並列2分法の実装}
  \begin{block}{実対称帯行列に対する並列2分法}
    \begin{algorithmic}[1]
      \Function{ParallelBandBisection}{$B$, $\ell$}
      \State Set $\mu^L_1, \mu^R_1$
      \Comment Use Gerschgorin theorem, etc.
      \State $k^{\textrm{next}}_b:=1,\ k^{\textrm{next}}_e:=1$
      \Repeat
      \State $k_b:=k^{\textrm{next}}_b,\ k_e:=k^{\textrm{next}}_e$ 
      \State \textcolor{red}{\texttt{!\$omp parallel do private($\mu_k$)}}
      \Do{$k:=k_b$ to $k_e$}
      \Comment $k_e \le \ell$
      \State $\mu_k := (\mu^L_k+\mu^R_k) / 2$
      \State \textcolor{blue}{Compute $\nu_B( \mu_k)$}
      \EndDo
      \State Update $\mu^L_k, \mu^R_k$, and $k^{\textrm{next}}_e$ for $k=k_b,\ \dots,\ k_e$ %(See Table~\ref{tab:update-rule-bisection})
      \State
      \begin{varwidth}[t]{\textwidth}
        Check $|\mu^L_k - \mu^R_k |$ for $k=k_b,\ \dots,\ k_e$ \\
        \& Update $\mu^L_k$, $\mu^R_k$, and $k^{\textrm{next}}_b$ if necessary
      \end{varwidth}
      \Until{$k^{\textrm{next}}_b > k^{\textrm{next}}_e$}
      \State $\mu_k := (\mu^L_k+\mu^R_k) / 2$ for $k=1,\ \dots,\ \ell$ \& Sort them in descending order
      \State \Return $\tilde{\lambda}_k := \mu_k$ for $k=1,\ \dots,\ \ell$
      \EndFunction
    \end{algorithmic}
  \end{block}
\end{frame}

%% \begin{frame}[shrink]
%%   \frametitle{実対称帯行列に対する並列2分法の実装}
%%   \begin{block}{実対称帯行列に対する並列2分法}
%%     \begin{algorithmic}[1]
%%       \Function{ParallelBandBisection}{$B$, $\ell$}
%%       \State Set $\mu^L_1, \mu^R_1$
%%       \Comment Use Gerschgorin theorem, etc.
%%       \State $k^{\textrm{next}}_b:=1,\ k^{\textrm{next}}_e:=1$
%%       \Repeat
%%       \State $k_b:=k^{\textrm{next}}_b,\ k_e:=k^{\textrm{next}}_e$ 
%%       \State \textcolor{red}{\texttt{!\$omp parallel do private($\mu_k$)}}
%%       \Do{$k:=k_b$ to $k_e$}
%%       \Comment $k_e \le \ell$
%%       \State $\mu_k := (\mu^L_k+\mu^R_k) / 2$
%%       \State \textcolor{blue}{Compute $\nu_B( \mu_k)$}
%%       \EndDo
%%       \State Update $\mu^L_k, \mu^R_k$, and $k^{\textrm{next}}_e$ for $k=k_b,\ \dots,\ k_e$ %(See Table~\ref{tab:update-rule-bisection})
%%       \State
%%       \begin{varwidth}[t]{\textwidth}
%%         Check $|\mu^L_k - \mu^R_k |$ for $k=k_b,\ \dots,\ k_e$ \\
%%         \& Update $\mu^L_k$, $\mu^R_k$, and $k^{\textrm{next}}_b$ if necessary
%%       \end{varwidth}
%%       \Until{$k^{\textrm{next}}_b > k^{\textrm{next}}_e$}
%%       \State $\mu_k := (\mu^L_k+\mu^R_k) / 2$ for $k=1,\ \dots,\ \ell$ \& Sort them in descending order
%%       \State \Return $\tilde{\lambda}_k := \mu_k$ for $k=1,\ \dots,\ \ell$
%%       \EndFunction
%%     \end{algorithmic}
%%   \end{block}
%% \end{frame}

\begin{frame}
  \frametitle{固有値計算の計算時間 (16 threads)}
  \begin{minipage}{.5\textwidth}
    \underline{$B_1$: $n=20,000$, $w=64$, random}\\
    \centering
    %% \includegraphics[scale=.7]{./fig/time_bisec_b1color}
  \end{minipage}
  \begin{minipage}{.45\textwidth}
    \underline{$B_2$: $n=40,000$, $w=256$, random}\\
    \centering
    %% \includegraphics[scale=.7]{./fig/time_bisec_b2color}
  \end{minipage}

  \begin{itemize}
  \item \underline{OpenMPによる単純な並列化}を施している
  \end{itemize}

  \begin{block}{数値実験結果の観測}
    \begin{itemize}
    \item[\checkmark] Murata においては、ブロックLUが大半を占める（97\%以上）
    \item Murataの2分法の方が，Guptaの2分法に比べて高速
      \begin{itemize}
      \item for $B_1$: ($\ell=250$) 2.1x, ($\ell=500$) 2.1x, ($\ell=1,000$) 2.1x 
      \item for $B_2$: ($\ell=250$) 2.6x, ($\ell=500$) 3.0x, ($\ell=1,000$) 3.0x
      \end{itemize}
    \end{itemize}
  \end{block}
\end{frame}

%%% Eigenvector computation
%%% Difference between Tri and Band
\begin{frame}
  \frametitle{逆反復法による固有ベクトル計算}

  \begin{itemize}
  \item[\checkmark] 帯行列の固有ベクトル計算 [Gupta (1973)] [Murata (1986)]: 逆反復法
  \end{itemize}
  \begin{block}{逆反復法 [Kahan (1966), etc.]}
    \begin{itemize}
    \item $\tilde{\lambda}_k$: $T$の固有値$\lambda_k$の近似値（$1 \le k \le m$）
    \item $\bm{q}_k$: $\lambda_k$に対応する固有ベクトル
    \item[\checkmark] 以下の連立1次方程式を反復して解くことで、$\bm{v}_k^{(i)}$は$\bm{q}_k$に収束する:
      \begin{align*}
        \left( B - \tilde{\lambda}_k I \right) \bm{v}_k^{(i)} 
        = \bm{v}_k^{(i-1)}
      \end{align*}
    \end{itemize}
  \end{block}

  \begin{alertblock}{Remark: クラスター固有値に対する固有ベクトル計算}
    \begin{itemize}
    \item \textcolor{red}{再直交化} が必要 
    \item クラスターの判定基準 [Peters-Wilkinson (1971)]: 
      \begin{itemize}
      \item $| \tilde{\lambda}_k-\tilde{\lambda}_{k-1}| < 10^{-3} \times \| B \|$ ($2\le k \le m$)
      \item[\checkmark] $n\ge 1000$で多くの固有値が同一のクラスタに属する [Dhillon (1997)]
      \end{itemize}
    \end{itemize}
  \end{alertblock}

  \begin{itemize}
  \item 実対称3重対角行列向け: \texttt{dstein} [Kahan (1966), etc.] in LAPACK
  \end{itemize}
\end{frame}

\begin{frame}[shrink]
  \frametitle{従来法：実対称帯行列に対する再直交化付き逆反復法 (Inv)}
  \begin{block}{Alg. 実対称帯行列に対する再直交化付き逆反復法 (Inv)}
    \begin{algorithmic}[1]
      \Function{BandInv}{$B,\ \ell,\ \tilde{\lambda}_1, \ \dots, \ \tilde{\lambda}_\ell$}
      \Do{$k:=1$ to $\ell$}
      \State $i:=0$
      \State Generate an initial random vector: $\bm{v}_k^{(0)}$
      \State \fcolorbox{blue}{blue!20}{$B - \tilde{\lambda}_k = P_k L_k U_k$}
      \Comment Call \texttt{dgbtrf}
      \Repeat
      \State $i:=i+1$
      \State Normalize $\bm{v}_k^{(i-1)}$ to $\bm{q}_k^{(i-1)}$
      \State \fcolorbox{blue}{blue!20}{Solve $P_k L_k U_k \bm{v}_k^{(i)} = \bm{q}_k^{(i-1)}$}
      \Comment Call \texttt{dgbtrs}
      \If{$k>1$ and $|\tilde{\lambda}_{k-1} - \tilde{\lambda}_k | \le 10^{-3} \times \max(|\tilde{\lambda}_1|,|\tilde{\lambda}_n|)$, }
      \State \fcolorbox{darkgreen}{darkgreen!10}{$\bm{v}_k^{(i)}$を再直交化して$\bm{q}_k^{(i)}$とする}
      \Comment MGS法
      \Else
      \State $k_1 := k$
      \EndIf
      \Until{some condition is met.}
      \State Normalize $\bm{v}_k^{(i)}$ to $\bm{q}_k^{(i)}$
      \State $Q_k := \begin{bmatrix} Q_{k-1} & \bm{q}_k^{(i)} \end{bmatrix}$
      \EndDo
      \State \Return $Q_\ell = \begin{bmatrix} \bm{q}_1 & \cdots & \bm{q}_\ell \end{bmatrix}$
      \EndFunction
    \end{algorithmic}
  \end{block}
\end{frame}

\begin{frame}
  \frametitle{再直交化付き逆反復法の並列計算による高速化}
  \begin{block}{逆反復法の計算量と並列化}
    \begin{itemize}
    \item 計算量: \textcolor{red}{再直交化計算}がボトルネック
      \begin{itemize}
      \item 連立方程式の求解: $O(\ell n)$
      \item 再直交化計算: \underline{$O(\ell^2 n)$} $\to$ 修正Gram-Schmidt（MGS）法（BLAS 1）
      \end{itemize}
    \item 並列化: 再直交化を要する場合、\textcolor{blue}{各行の計算内}でしか並列化できない
    \end{itemize}
  \end{block}

  \begin{itemize}
  \item BLAS (Basic Linear Algebra Subprograms)
    \begin{itemize}
    \item BLAS 1: ベクトル演算
    \item BLAS 2: 行列-ベクトル乗算
    \item BLAS 3: 行列(-行列)乗算
    \end{itemize}
  \item 性能: BLAS 3$>$BLAS 2$>$BLAS 1（条件付）
  \item ライブラリによっては、並列実装も提供されている
  \end{itemize}

%%   \begin{alertblock}{Chapter 3 \& 4の位置付け}
%%     \begin{itemize}
%%     \item 課題: 再直交化計算の並列化による高速化
%%     \item[\checkmark] 行列-ベクトル乗算(3)や行列乗算(4)で構成された逆反復法
%%     \end{itemize}
%%   \end{alertblock}

%% \end{frame}

%% \begin{frame}
%%   \frametitle{BLAS 3で構成される逆反復アルゴリズム}
  
%%   \begin{itemize}
%%   \item BLAS 2で構成される再直交化アルゴリズムによりある程度の高速化ができた
%%     \begin{itemize}
%%     \item BLAS 3であれば更に高速化ができるのでは?
%%     \end{itemize}
%%   \item[\checkmark] BLAS 3で構成される再直交化アルゴリズムは? $\to$ \underline{存在しない}
%%   \end{itemize}

  \begin{alertblock}{BLAS 3で構成される逆反復アルゴリズム:}
    \begin{itemize}
    \item 同時逆反復法 (SI) [Chatelin (1993)]
    \item[\checkmark] 提案法: \textcolor{red}{再直交化付きブロック逆反復法} (BIR)
    \end{itemize}
  \end{alertblock}
\end{frame}

\begin{frame}{BIR: 再直交化付きブロック逆反復法}
  \begin{itemize}
  \item[\checkmark] \textcolor{blue}{$r$個の固有値に対する同時逆反復} ($r$: ブロックサイズ, $r<\hat{\ell}$)\\ 
    +計算済みのベクトルに対する\textcolor{red}{再直交化}計算
  \end{itemize}
  \begin{exampleblock}{BIR: 再直交化付きブロック逆反復法}
    \begin{algorithmic}[1]
      \State Solve $\left( B-\tilde{\lambda}_k I \right) \bm{v}_k^{(i)} = \bm{q}_k^{(i-1)}$ \textcolor{blue}{for $k=r(j-1)+1,\ \dots,\ rj$}
      %% \State \fcolorbox{red}{darkred!10}{Reorthogonalize $V_{j,r}^{(i)}$ against $\bm{q}_1,\ \dots,\ \bm{q}_{r(j-1)}$} {\footnotesize $\left(V_{j,r}^{(i)}=\begin{bmatrix} \bm{v}_{r(j-1)+1}^{(i)} & \cdots & \bm{v}_{rj}^{(i)} \end{bmatrix}\right)$}
      \State Reorthogonalize $V_{j,r}^{(i)}$ against $\bm{q}_1,\ \dots,\ \bm{q}_{r(j-1)}$ {\footnotesize $\left(V_{j,r}^{(i)}=\begin{bmatrix} \bm{v}_{r(j-1)+1}^{(i)} & \cdots & \bm{v}_{rj}^{(i)} \end{bmatrix}\right)$}
      \State $V_{j,r}^{(i)} := Q_{j,r}^{(i)} R_{j,r}^{(i)}$ {\footnotesize $\left(Q_{j,r}^{(i)}=\begin{bmatrix} \bm{q}_{r(j-1)+1}^{(i)} & \cdots & \bm{q}_{rj}^{(i)} \end{bmatrix},\ R^{(i)} \in \mathbb{R}^{r \times r}\right)$}
    \end{algorithmic}
    %% }
  \end{exampleblock}
  \begin{alertblock}{Remark: }
    \begin{itemize}
    \item 2+3: ブロック再直交化
      \begin{itemize}
      \item Block CGS2 algorithm [Barlow {\em et al.} (2012), etc.]（BLAS 3）
      \end{itemize}
    \item ワーキングメモリ: $r(3w+1)n$ （同時逆反復法の場合 $\ell (3w+1)n$）
    \item[\checkmark] \textcolor{red}{計算量は従来のアルゴリズムとほぼ同等}
      %% \begin{itemize}
      %% \item $r=\hat{\ell}$のとき: 同時逆反復法に対応
      %% \item $r=1$のとき: 再直交化付き逆反復法に対応
      %% \end{itemize}
    \end{itemize}
  \end{alertblock}
\end{frame}

%%% 2: BIR
\begin{frame}[shrink]
  \frametitle{提案法：実対称帯行列に対する再直交化付きブロック逆反復法(BIR)}
  \begin{exampleblock}{Alg.~実対称帯行列に対する再直交化付きブロック逆反復法 (BIR)}
    %\footnotesize
    \begin{algorithmic}[1]
      \Function{BandBIR}{$B,\  r,\ \hat{\ell},\ \tilde{\lambda}_1, \ \dots, \ \tilde{\lambda}_{\hat{\ell}}$}
      \State Set an $n \times r$ matrix $Q_0$ be $Q_0 := \bm{O}$
      \Do{$j:=1$ to $\hat{\ell}/r$}
      \State $i := 0$
      \State Generate $Q^{(0)}_{j,r} := \begin{bmatrix} \bm{q}^{(0)}_{(j-1)r+1} & \cdots & \bm{q}^{(0)}_{jr} \end{bmatrix}$
      \State \textcolor{red}{\texttt{!\$omp parallel do}}
      \Do{$k=:(j-1)r+1$ to $jr$}
      \State \fcolorbox{blue}{blue!20}{$B - \tilde{\lambda}_k = P_k L_k U_k$}
      \Comment Call \texttt{dgbtrf}
      \EndDo
      \Repeat
      \State $i := i+1$
      \State \textcolor{red}{\texttt{!\$omp parallel do}}
      \Do{$k=:(j-1)r+1, \ \dots, \ jr$}
      \State \fcolorbox{blue}{blue!20}{Solve $P_k L_k U_k \bm{v}^{(i)}_k = \bm{q}^{(i-1)}_k$} %by forward and backward substitution
      \Comment Call \texttt{dgbtrs}
      \EndDo
      \State \fcolorbox{red}{darkred!10}{$V^{(i)}_{j,r} := V^{(i)}_{j,r} - Q_{(j-1)r} Q_{(j-1)r}^\top V_{j,r}$}
      \Comment Call \texttt{dgemm} $\times 2$
      \State \fcolorbox{darkgreen}{darkgreen!10}{$V^{(i)}_{j,r} = \overline{Q}^{(i)}_{j,r} R^{(i)}_{j,r}$}
      \Comment QR分解
      \State \fcolorbox{red}{darkred!10}{$\overline{Q}^{(i)}_{j,r} := \overline{Q}^{(i)}_{j,r} - Q_{(j-1)r} Q_{(j-1)r}^\top \overline{Q}^{(i)}_{j,r}$}
      \Comment Call \texttt{dgemm} $\times 2$
      \State \fcolorbox{darkgreen}{darkgreen!10}{$\overline{Q}^{(i)}_{j,r} = Q^{(i)}_{j,r} R^{(i)}_{j,r}$}
      \Comment QR分解
      \Until{converge}
      \State $Q_{jr} := \begin{bmatrix} Q_{(j-1)r} & Q^{(i)}_{j,r} \end{bmatrix}$  $\left( Q_r := \left[ Q^{(i)}_{1,r} \right] \right)$
      \EndDo
      \State \Return $Q_{\hat{\ell}} = \begin{bmatrix} \bm{q}_1 & \cdots & \bm{q}_{\hat{\ell}} \end{bmatrix}$
      \EndFunction
    \end{algorithmic}
  \end{exampleblock}
\end{frame}

%% %%% Comparison
%% \begin{frame}
%%   \frametitle{従来法（Inv）と提案法（BIR）の比較}
%%   \begin{minipage}{.47\hsize}
%%         \scriptsize
%%   \begin{block}{Alg.~Inv（抜粋）}
%%     \begin{algorithmic}[1]
%%       \scriptsize
%%       %% \State $i:=0$
%%       %% \State Generate $\bm{v}_k^{(0)}$
%%       \State \fcolorbox{blue}{blue!20}{$B - \tilde{\lambda}_k = P_k L_k U_k$}
%%       \Repeat
%%       \State $i:=i+1$
%%       \State Normalize $\bm{v}_k^{(i-1)}$ to $\bm{q}_k^{(i-1)}$
%%       \State \fcolorbox{blue}{blue!20}{Solve $P_k L_k U_k \bm{v}_k^{(i)} = \bm{q}_k^{(i-1)}$}
%%       \State \fcolorbox{darkgreen}{darkgreen!10}{$\bm{v}_k^{(i)}$の再直交化$\to\bm{q}_k^{(i)}$}
%%       \Until{some condition is met.}
%%       %% \State Normalize $\bm{v}_k^{(i)}$ to $\bm{q}_k^{(i)}$
%%       %% \State $Q_k := \begin{bmatrix} Q_{k-1} & \bm{q}_k^{(i)} \end{bmatrix}$
%%       %% \EndDo
%%     \end{algorithmic}
%%   \end{block}
%%   \end{minipage}\hfill
%%   \begin{minipage}{.47\hsize}
%%         \scriptsize
%%     \begin{exampleblock}{Alg.~BIR（抜粋）}
%%       \begin{algorithmic}[1]
%%         \scriptsize
%%         \State 
%%         \fcolorbox{blue}{blue!20}{$B - \tilde{\lambda}_k = P_k L_k U_k$} for $k=:(j-1)r+1$ to $jr$
%%         \Repeat
%%         \State $i := i+1$
%%         \State
%%         \begin{varwidth}[t]{\textwidth}
%%           \fcolorbox{blue}{blue!20}{Solve $P_k L_k U_k \bm{v}^{(i)}_k = \bm{q}^{(i-1)}_k$} \\
%%           \qquad for $k=:(j-1)r+1$ to $jr$%by forward and backward substitution
%%         \end{varwidth}
%%         \State \fcolorbox{red}{darkred!10}{$V^{(i)}_{j,r} := V^{(i)}_{j,r} - Q_{(j-1)r} Q_{(j-1)r}^\top V_{j,r}$}
%%         \State \fcolorbox{darkgreen}{darkgreen!10}{$V^{(i)}_{j,r} = \overline{Q}^{(i)}_{j,r} R^{(i)}_{j,r}$}
%%         \State \fcolorbox{red}{darkred!10}{$\overline{Q}^{(i)}_{j,r} := \overline{Q}^{(i)}_{j,r} - Q_{(j-1)r} Q_{(j-1)r}^\top \overline{Q}^{(i)}_{j,r}$}
%%         \State \fcolorbox{darkgreen}{darkgreen!10}{$\overline{Q}^{(i)}_{j,r} = Q^{(i)}_{j,r} R^{(i)}_{j,r}$}
%%         \Until{some condition is met.}
%%       \end{algorithmic}
%%     \end{exampleblock}
%%   \end{minipage}
%%   %% \begin{itemize}
%%   %% \item 従来法と提案法の相違点
%%     \begin{center}
%%       \begin{tabular}{lcc}
%%         （並列化方法）& Inv-MGS & BIR \\\hline\hline
%%         連立1次方程式の求解 & \textcolor{blue}{Intel MKL} & \textcolor{red}{OpenMP} \\
%%         （ブロック）再直交化 & \textcolor{blue}{Intel MKL} & \textcolor{blue}{Intel MKL} \\\hline
%%     \end{tabular}
%%     \end{center}
%%   %% \end{itemize}
%% \end{frame}

%%% 3: Cost
\begin{frame}{計算量および並列化手法の比較}
  \begin{block}{計算量および並列化手法の比較}
    \begin{center}
      \scalebox{.9}{
        \begin{tabular}{lcc}
          %% & $B\to T$ + EVD for $T$
          & EVD for $B$ & 並列化\\ \hline\hline
          %% 帯行列の3重対角化 & \textcolor{red}{$O(wn^2)$} & - & Intel MKL\\\hline 
          2分法 & \textcolor{red}{$O(\ell w^2 n)$} & OpenMP \\\hline
          連立1次方程式の求解 & \textcolor{blue}{$O(\ell w^2 n)$} & (*) \\ 
          再直交化 & $O(\hat{\ell}_{\max}^2 n)$ & Intel MKL \\\hline
          \multicolumn{3}{c}{(*): （Inv）Intel MKLベース，（BIR）OpenMPベース}
        \end{tabular}
      }
    \end{center}
  \end{block}

  \begin{itemize}
  \item 変数の説明:
    \begin{itemize}
    \item $n$: 行列サイズ
    \item $w$: 実帯対称行列$B$の半帯幅
    \item $\ell$: 求めたい固有対の数
      %% \item $\ell$: $\nu$の計算回数 (おおよそ$\ell$に比例)
    \item $\hat{\ell}_{\max}$: 最大の固有値クラスターに属する固有値の数
    \end{itemize}
  \end{itemize}

  \begin{itemize}
    \item[\checkmark] 2分法と逆反復の反復回数:
      \begin{itemize}
      \item 逆反復法（実験では3回）に比べると，2分法の回数は非常に多い
      \end{itemize}
  \end{itemize}
    %% \begin{itemize}
  %% \item[\checkmark] BIR: 「連立1次方程式の求解」は，少ない同期で並列化できる
  %% \end{itemize}
\end{frame}


%%% Numerical experiments
\begin{frame}
  \frametitle{共有メモリマルチコア計算機上での性能評価}
  \begin{block}{数値実験の内容}
    \begin{itemize}
    \item 実対称帯行列の固有対を最大のものから$\ell$個だけ計算
      \begin{itemize}
      \item $\ell \in \{250,500,1000\}$
      \end{itemize}
    \item テスト行列 ($w$: 半帯幅，各要素は$(0,1)$の一様乱数)
      \begin{itemize}
      \item $B_1$: $n=20,000$, $w=64$
      \item $B_2$: $n=40,000$, $w=256$
      \end{itemize}
    \end{itemize}
  \end{block}

  \begin{minipage}{.5\textwidth}
    \underline{$B_1$の固有値分布}\\
    \centering
    %% \includegraphics[scale=.6]{./fig/eigval_index1000_b1.pdf}
  \end{minipage}
  \begin{minipage}{.45\textwidth}
    \underline{$B_2$の固有値分布}\\
    \centering
    %% \includegraphics[scale=.6]{./fig/eigval_index1000_b2.pdf}
  \end{minipage}

\end{frame}

\begin{frame}
  \frametitle{評価環境}

 \begin{center}
    \begin{tabular}{ll}
      \multicolumn{2}{c}{京都大学学術情報メディアセンター Appro GreenBlade 8000}\\\hline\hline
      CPU         & Intel Xeon E5-2670@2.6GHz, 16 cores (8 cores $\times$ 2) \\
      & L3 cache: 20MB $\times$ 2 \\
      RAM         & DDR3-1600 64GB, 136.4GB/sec \\
      Compiler 	& Intel C++/Fortran Compiler 15.0.2 \\
      Options 	& \texttt{-O3 -xHOST -ipo -no-prec-div} \\ 
      & \texttt{-openmp -mcmodel=medium -shared-intel} \\
      Software 	& Intel Math Kernel Library 11.2.2\\\hline 
      %%  	Run option  & \texttt{numactl -i all}
    \end{tabular}
    \begin{itemize}
    \item 16スレッド並列で実行
    \end{itemize}
  \end{center}

\end{frame}

\begin{frame}%[shrink]
  \frametitle{実験コード}
  \begin{exampleblock}{Proposed: 提案法コード}
    \begin{itemize}
    \item 実対称帯行列向け 2分法（Murata）\\
      +再直交化付きブロック逆反復法（BandBIR，$r=16\ (=\text{\# of max threads})$）
    \end{itemize}
  \end{exampleblock}

  \begin{block}{従来法コード}
    \begin{itemize}
  \item 実対称帯行列向け2分法+逆反復法
      \begin{itemize}
      \item MGS法を再直交化に実装（BandInv-MGS）
      \end{itemize}
    \end{itemize}
  \end{block}
\end{frame}

\begin{frame}
  \frametitle{実行時間の比較 (Inv-MGS vs. BIR, 16 threads)}
  \begin{minipage}{.5\textwidth}
    \underline{$B_1$: $n=20,000$, $w=64$, random}\\
    \centering
    %% \includegraphics[scale=.6]{./fig/time_vec_b1color}
  \end{minipage}
  \begin{minipage}{.45\textwidth}
    \underline{$B_2$: $n=40,000$, $w=256$, random}\\
    \centering
    %% \includegraphics[scale=.6]{./fig/time_vec_b2color}
  \end{minipage}
  \begin{itemize}
  \item BIR（提案法）は Inv-MGS（従来法）よりも高速
    \begin{itemize}
    \item for $B_1$: ($\ell=250$) 6.3x, ($\ell=500$) 6.8x, ($\ell=1,000$) 7.4x 
    \item for $B_2$: ($\ell=250$) 7.5x, ($\ell=500$) 8.3x, ($\ell=1,000$) 8.7x
    \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{実行時間の内訳 (Murata+Inv-MGS vs. Murata+BIR, 16 threads)}
  \begin{minipage}{.5\textwidth}
    \underline{$B_1$: $n=20,000$, $w=64$, random}\\
    \centering
    %% \includegraphics[scale=.7]{./fig/breakdown_b1color}
  \end{minipage}
  \begin{minipage}{.45\textwidth}
    \underline{$B_2$: $n=40,000$, $w=256$, random}\\
    \centering
    %% \includegraphics[scale=.7]{./fig/breakdown_b2color}
  \end{minipage}
  \begin{itemize}
  \item 並列2分法の割合が高い:
    \begin{itemize}
    \item[\checkmark] 多分法の導入など、2分法の更なる高速化が必要
    \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}%[shrink]
  \frametitle{実験コード}
  \begin{exampleblock}{Proposed: 提案法コード}
    \begin{itemize}
    \item 実対称帯行列向け 2分法（Murata）\\
      +再直交化付きブロック逆反復法（BandBIR，$r=16\ (=\text{\# of max threads})$）
    \end{itemize}
  \end{exampleblock}

  \begin{block}{従来法コード}
    \begin{itemize}
  \item 実対称帯行列向け2分法+逆反復法
      \begin{itemize}
      \item MGS法を再直交化に実装（BandInv-MGS）
      \end{itemize}
    \item 3重対角行列を経由する解法に基づくコード
      \begin{itemize}
      \item \texttt{dsbevx}（Intel MKL）:
        \begin{itemize}
        \item 3重対角化（\texttt{dsbtrd}）+2分法（\texttt{dstebz}）+逆反復法（\texttt{dstein}）+逆変換
        \end{itemize}
      \item 実対称3重対角行列の固有対計算を差し替えたもの \\
        (3重対角行列化 \& 逆変換は\texttt{dsbevx}と同じルーチン，\\
        固有値計算は共通して並列2分法): 
        \begin{itemize}
        \item Tridiag+Bisec+Inv-MGS（Inv-MGS: \texttt{dstein}）
        \item Tridiag+Bisec+BIR（$r=16$）
        \end{itemize}
      \end{itemize}
    \end{itemize}
  \end{block}
\end{frame}

\begin{frame}
  \frametitle{精度の比較: (上) 残差$\| BQ-QD \|_\infty / \ell$ (下) 直交性$\| Q^\top Q-I \|_\infty / \ell$}
  \begin{minipage}{.5\textwidth}
    \underline{$B_1$: $n=20,000$, $w=64$, random}\\
    \centering
    %% \includegraphics[scale=.65]{./fig/res_b1color}\\
    %% \includegraphics[scale=.65]{./fig/orth_b1color}
  \end{minipage}
  \begin{minipage}{.45\textwidth}
    \underline{$B_2$: $n=40,000$, $w=256$, random}\\
    \centering
    %% \includegraphics[scale=.65]{./fig/res_b2color}\\
    %% \includegraphics[scale=.65]{./fig/orth_b2color}
  \end{minipage}
\end{frame}

\begin{frame}
  \frametitle{実行時間の比較 (従来法 vs. 提案法, 16 threads)}
  \begin{minipage}{.5\textwidth}
    \underline{$B_1$: $n=20,000$, $w=64$, random}\\
    \centering
    %% \includegraphics[scale=.7]{./fig/time_b1color}
  \end{minipage}
  \begin{minipage}{.45\textwidth}
    \underline{$B_2$: $n=40,000$, $w=256$, random}\\
    \centering
    %% \includegraphics[scale=.7]{./fig/time_b2color}
  \end{minipage}
  
  \begin{itemize}
  \item 提案法は，\texttt{dsbevx} (Intel MKL) に比べて高速
    \begin{itemize}
    \item for $B_1$: ($\ell=250$) 6.5x, ($\ell=500$) 4.9x, ($\ell=1,000$) 3.9x 
    \item for $B_2$: ($\ell=250$) 3.5x, ($\ell=500$) 2.2x, ($\ell=1,000$) 1.5x
    \end{itemize}
  \item[\checkmark] 3重対角化を行わない場合，$\ell$が大きいほど計算時間が増加しやすい
    %% 大きくなると\texttt{dsbevx} (Intel MKL) に比べて高速
  \end{itemize}
\end{frame}

%%% 3: Cost
\begin{frame}{計算量および並列化手法の比較}
  \begin{block}{計算量および並列化手法の比較}
    \begin{center}
      \scalebox{.9}{
        \begin{tabular}{lccc}
          & $B\to T$ + EVD for $T$ & EVD for $B$ & 並列化\\ \hline\hline
          帯行列の3重対角化 & \textcolor{red}{$O(wn^2)$} & - & Intel MKL\\\hline 
          2分法 & $O(\ell n)$ & \textcolor{red}{$O(\ell w^2 n)$} & OpenMP \\\hline
          連立1次方程式の求解 & $O(\ell n)$ & \textcolor{blue}{$O(\ell w^2 n)$} & (*) \\ 
          再直交化 & $O(\hat{\ell}_{\max}^2 n)$ & $O(\hat{\ell}_{\max}^2 n)$ & Intel MKL \\\hline
          逆変換 & \textcolor{blue}{$O(\ell n^2)$} & - & Intel MKL \\\hline
          \multicolumn{4}{c}{(*): （Inv）Intel MKLベース，（BIR）OpenMPベース}
        \end{tabular}
      }
    \end{center}
  \end{block}

  \begin{itemize}
  \item 変数の説明:
    \begin{itemize}
    \item $n$: 行列サイズ
    \item $w$: 実帯対称行列$B$の半帯幅
    \item $\ell$: 求めたい固有対の数
      %% \item $\ell$: $\nu$の計算回数 (おおよそ$\ell$に比例)
    \item $\hat{\ell}_{\max}$: 最大の固有値クラスターに属する固有値の数
    \end{itemize}
  \end{itemize}

  \begin{itemize}
    \item[\checkmark] 2分法と逆反復の反復回数:
      \begin{itemize}
      \item 逆反復法（実験では3回）に比べると，2分法の回数は非常に多い
      \end{itemize}
  \end{itemize}
    %% \begin{itemize}
  %% \item[\checkmark] BIR: 「連立1次方程式の求解」は，少ない同期で並列化できる
  %% \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{従来法の実行時間の内訳)}
  \begin{minipage}{.5\textwidth}
    \underline{$B_1$: $n=20,000$, $w=64$, random}\\
    \centering
    %% \includegraphics[scale=.7]{./fig/breakdown_b1convcolor}
  \end{minipage}
  \begin{minipage}{.45\textwidth}
    \underline{$B_2$: $n=40,000$, $w=256$, random}\\
    \centering
    %% \includegraphics[scale=.7]{./fig/breakdown_b2convcolor}
  \end{minipage}

  \begin{itemize}
  \item 大半の計算が3重対角化（計算量: $O(wn^2)$）
  \item[\checkmark] $\ell$が増えることで``逆変換"の計算量$O(\ell n^2)$が増えてくる
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{実行時間の比較 (従来法 vs. 提案法, 16 threads)}
  \begin{minipage}{.5\textwidth}
    \underline{$B_1$: $n=20,000$, $w=64$, random}\\
    \centering
    %% \includegraphics[scale=.7]{./fig/logtime_b1color}
  \end{minipage}
  \begin{minipage}{.45\textwidth}
    \underline{$B_2$: $n=40,000$, $w=256$, random}\\
    \centering
    %% \includegraphics[scale=.7]{./fig/logtime_b2color}
  \end{minipage}

  \begin{itemize}
  \item $\ell$が大きくなれば提案法のほうが遅くなる
  \end{itemize}
  \begin{block}{性能のターニングポイント}
    \begin{itemize}
    \item 計算量から考えられる指標: \underline{$C \times \frac{lw}{n}$, $C$: 計算環境に依存する定数}
      \begin{itemize}
      \item 従来法の3重対角化: $O(w n^2)$
      \item 提案法: $O(lw^2 n)$
      \end{itemize}
    \end{itemize}
  \end{block}
\end{frame}

\begin{frame}
  \frametitle{まとめ}
  \begin{alertblock}{本講演のまとめ}
  \begin{itemize}
  \item {[Murata(1986)]}の2分法による固有値計算
    \begin{itemize}
    \item ブロックLU分解とMartin-Wilkinson's special Gaussを利用
    \item OpenMPによる簡単な並列化
      %% \item[\checkmark] Block LU fact. effectively accelerates the eigenvalue computation 
    \end{itemize}
  \end{itemize}

  \begin{itemize}
  \item 再直交化付きブロック逆反復法による固有ベクトル計算
    \begin{itemize}
    \item 行列乗算中心+連立1次方程式を並列で計算
    \item[\checkmark] 逆反復+MGS法よりも高速
    \end{itemize}
  \end{itemize}

  \begin{itemize}
  \item 共有メモリマルチコアプロセッサ上での数値実験
    \begin{itemize}
    \item 実対称帯行列向け2分法＋再直交化付きブロック逆反復法により，\\
      従来実装よりも高速な固有対計算が実現できることを確認
      \begin{itemize}
      \item 特に，要求される固有対が少ないときに有効 
      \end{itemize}
    \end{itemize}
  \end{itemize}
  \end{alertblock}
\end{frame}

%% \begin{frame}
%%   \frametitle{Future work}

%%   \begin{block}{Future work}
%%     \begin{itemize}
%%     \item 前処理アルゴリズムを伴う実装コードの開発
%%       \begin{itemize}
%%       \item Bischof's or Wu's band reduction
%%       \item Block Golub-Kahan-Lanczos algorithm 
%%       \end{itemize}
%%     \item 分散メモリ型並列計算機向けの実装\&性能評価
%%     \end{itemize}
%%   \end{block}

%%   \begin{alertblock}{Remark: 再直交化付きブロック逆反復法}
%%     \begin{itemize}
%%     \item 再直交化アルゴリズムやQR分解には他のアルゴリズムを実装可能
%%     \item Communication-avoidingなQR分解: 
%%       \begin{itemize}
%%       \item コレスキーQR2法 [Fukaya, et al. (2014)]
%%       \item シフト付きコレスキー分解 [Yanagisawa, et al.]
%%       \end{itemize}
%%     \end{itemize}
%%   \end{alertblock}

%% \end{frame}

%% \begin{frame}
%%   \frametitle{Related work}
%%   \begin{exampleblock}{Twisted factorization (or, MR3 algorithm) for computing eigenpair subsets}
%%     \begin{itemize}
%%     \item for symmetric tridiagonal
%%       \begin{itemize}
%%       \item {[Parlett-Dhilon (2000)]}
%%       \item {[Willems-Lang (2012)]}
%%       \end{itemize}
%%     \item for symmetric block tridiagonal 
%%       \begin{itemize}
%%       \item {[K\"{o}niga-Moldaschlb-Gansterer (2012)]}
%%       \end{itemize}
%%     \end{itemize}
%%   \end{exampleblock}

%%   \begin{block}{Parallel impl. of bisection algorithm for symmetric tridiagonal matrices}
%%     \begin{itemize}
%%     \item Parallelism w.r.t. the indices of eigenvalues
%%       \begin{itemize}
%%       \item ScaLAPACK: \texttt{PxSTEBZ} routine [Demmel-Dhillon-Ren (1994)]
%%       \end{itemize}
%%     \item Increase search point
%%       \begin{itemize}
%%       \item Multi-section method [Lo-Philippe-Sameh (1987)] [Simon (1989)]
%%       \item Multi-section with multiple eigenvalues method [Katagiri-V\"{o}mel-Demmel (2007)]
%%       \end{itemize}
%%     \end{itemize}
%%   \end{block}
%% \end{frame}

\begin{frame}{まとめ}
  \begin{block}{今後の課題}
    \begin{enumerate}
    \item 分散並列環境における実装と性能評価
      \begin{itemize}
      \item[\checkmark] 部分固有対計算法の高速化に役立つと期待される
      \item 更に高速な実装のためのアイディア: 
      \begin{itemize}
      \item 多分法などによる2分法の高速化
      \item 通信の少ないQR分解 [Demmel et al.~(2012), Fukaya et al.~(2014), etc.]
      \end{itemize}
    \end{itemize}
  \end{enumerate}
  \input{one_phase_band_evd_en.tex}
  \begin{enumerate}
    \setcounter{enumi}{1}
  %% \item アクセラレータ（GPUやIntel Xeon Phi）向けの実装と性能評価
  \item 提案法に前処理を加えたソルバの実装%とチューニング
    \begin{itemize}
    \item 実対称密行列向け: $A \to B$
    \item 疎行列向け: ブロックLanczos法（固有対計算）\\
      ブロックGolub-Kahan-Lanczos法（特異対計算）
    \end{itemize}
  \item 実問題への適用
  \end{enumerate}
  \end{block}

\end{frame}



\end{document}
